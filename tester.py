# from evodex.mapping import map_atoms

# if __name__ == "__main__":
#     smiles_input = "[At][C:1]([At])([At])[C:2](=[O:3])[O:4][C:5]([At])([At])[At].[At][O:6][At]>>[At][C:1]([At])([At])[C:2](=[O:3])[O:6][At].[At][O:4][C:5]([At])([At])[At]"
#     mapped_smiles = map_atoms(smiles_input)
#     print(f"Mapped SMILES: {mapped_smiles}")

# from evodex.splitting import split_reaction

# test_reaction = "[At:51]-[#6:1](-[At:52])(-[At:53])-[#6:2](=[#8:3])-[#6:4](-[At:54])(-[#6:5](-[At:55])(-[At:56])-[At:57])-[#8:6]-[At:58].[At+].[At:59]-[#7:7](-[At:60])-[#6:8](=[#8:9])-[#6:10]1=[#6:11](-[At:61])-[#7:12](-[#6@:13]2(-[At:62])-[#8:14]-[#6@:15](-[At:63])(-[#6:16](-[At:64])(-[At:65])-[#8:17]-[#15:18](=[#8:19])(-[#8:20]-[At:66])-[#8:21]-[#15:22](=[#8:23])(-[#8:24]-[At:67])-[#8:25]-[#6:26](-[At:68])(-[At:69])-[#6@@:27]3(-[At:70])-[#8:28]-[#6@@:29](-[At:71])(-[#7:30]4:[#6:31](-[At:72]):[#7:32]:[#6:33]5:[#6:34](-[#7:35](-[At:73])-[At:74]):[#7:36]:[#6:37](-[At:75]):[#7:38]:[#6:39]:4:5)-[#6@:40](-[At:76])(-[#8:41]-[At:77])-[#6@:42]-3(-[At:78])-[#8:43]-[At:79])-[#6@@:44](-[At:80])(-[#8:45]-[At:81])-[#6@@:46]-2(-[At:82])-[#8:47]-[At:83])-[#6:48](-[At:84])=[#6:49](-[At:85])-[#6:50]-1(-[At:86])-[At]>>[At:51]-[#6:1](-[At:52])(-[At:53])-[#6:2](-[At])(-[#8:3]-[At])-[#6:4](-[At:54])(-[#6:5](-[At:55])(-[At:56])-[At:57])-[#8:6]-[At:58].[At:59]-[#7:7](-[At:60])-[#6:8](=[#8:9])-[#6:10]1:[#6:11](-[At:61]):[#7+:12](-[#6@:13]2(-[At:62])-[#8:14]-[#6@:15](-[At:63])(-[#6:16](-[At:64])(-[At:65])-[#8:17]-[#15:18](=[#8:19])(-[#8:20]-[At:66])-[#8:21]-[#15:22](=[#8:23])(-[#8:24]-[At:67])-[#8:25]-[#6:26](-[At:68])(-[At:69])-[#6@@:27]3(-[At:70])-[#8:28]-[#6@@:29](-[At:71])(-[#7:30]4:[#6:31](-[At:72]):[#7:32]:[#6:33]5:[#6:34](-[#7:35](-[At:73])-[At:74]):[#7:36]:[#6:37](-[At:75]):[#7:38]:[#6:39]:4:5)-[#6@:40](-[At:76])(-[#8:41]-[At:77])-[#6@:42]-3(-[At:78])-[#8:43]-[At:79])-[#6@@:44](-[At:80])(-[#8:45]-[At:81])-[#6@@:46]-2(-[At:82])-[#8:47]-[At:83]):[#6:48](-[At:84]):[#6:49](-[At:85]):[#6:50]:1-[At:86]"
# result = split_reaction(test_reaction)
# for r in result:
#     print(r)
# print(len(result))

from evodex.decofactor import remove_cofactors

test_reaction = "[At:36]-[#6:1](-[At:37])(-[At])-[#6:2](=[#8:3])-[#6:4](=[#8:5])-[#8:6]-[At:39].[At:40]-[#6:7](-[At:41])(-[At:42])-[#6:8]1:[#6:9](-[At:43]):[#7:10](-[#6@@:11]2(-[At:44])-[#6:12](-[At:45])(-[At:46])-[#6@:13](-[At:47])(-[#8:14]-[At:48])-[#6@@:15](-[At:49])(-[#6:16](-[At:50])(-[At:51])-[#8:17]-[#15:18](=[#8:19])(-[#8:20]-[At:52])-[#8:21]-[#15:22](=[#8:23])(-[#8:24]-[At:53])-[#8:25]-[#15:26](=[#8:27])(-[#8:28]-[At:54])-[#8:29]-[At:55])-[#8:30]-2):[#6:31](=[#8:32]):[#7:33](-[At:56]):[#6:34]:1=[#8:35]>>[At:36]-[#6:1](-[At:37])=[#6:2](-[#8:3]-[#15:26](=[#8:27])(-[#8:28]-[At:54])-[#8:29]-[At:55])-[#6:4](=[#8:5])-[#8:6]-[At:39].[At:40]-[#6:7](-[At:41])(-[At:42])-[#6:8]1:[#6:9](-[At:43]):[#7:10](-[#6@@:11]2(-[At:44])-[#6:12](-[At:45])(-[At:46])-[#6@:13](-[At:47])(-[#8:14]-[At:48])-[#6@@:15](-[At:49])(-[#6:16](-[At:50])(-[At:51])-[#8:17]-[#15:18](=[#8:19])(-[#8:20]-[At:52])-[#8:21]-[#15:22](=[#8:23])(-[#8:24]-[At:53])-[#8:25]-[At])-[#8:30]-2):[#6:31](=[#8:32]):[#7:33](-[At:56]):[#6:34]:1=[#8:35]"
result = remove_cofactors(test_reaction)
print(result)